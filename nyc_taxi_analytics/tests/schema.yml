version: 2

models:
  - name: stg_taxi_trips
    description: >
      Staging model for NYC Yellow Taxi trips.
      Reads from processed S3 parquet files and applies base filters.
    columns:
      - name: tpep_pickup_datetime
        description: Pickup datetime
        tests:
          - not_null

      - name: tpep_dropoff_datetime
        description: Dropoff datetime
        tests:
          - not_null

      - name: trip_distance
        description: Distance traveled in miles
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100
              config:
                severity: warn

      - name: trip_duration_minutes
        description: Trip duration in minutes
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 1440
              config:
                severity: warn

      - name: passenger_count
        description: Number of passengers
        tests:
          - not_null
          - accepted_values:
              values: [1, 2, 3, 4, 5, 6, 7, 8]
              config:
                severity: warn

      - name: avg_speed_mph
        description: Calculated average speed in mph
        tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100
              config:
                severity: warn